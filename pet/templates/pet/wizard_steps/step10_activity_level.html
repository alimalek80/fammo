<!-- Activity Level Selection Section -->
<div class="mb-6">
  <div class="mb-6 text-lg font-medium text-center opacity-90">
    {% if form.pet_name %}
      How active is {{ form.pet_name }}?
    {% else %}
      {{ form.activity_level.label }}
    {% endif %}
  </div>
  
  <!-- Activity Level Options -->
  <div class="grid grid-cols-1 gap-4 max-w-2xl mx-auto">
    {% for choice in form.activity_level %}
      <label class="btn btn-outline btn-lg cursor-pointer activity-level-btn hover:btn-primary transition-all duration-200 p-6 h-auto text-left">
        {{ choice.tag }}
        <div class="ml-4 flex-1">
          <div class="text-xl font-bold mb-2">{{ choice.choice_label }}</div>
          <div class="text-sm opacity-75 font-normal">
            {% for activity in form.activity_levels %}
              {% if activity.name == choice.choice_label %}
                {{ activity.description }}
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </label>
    {% endfor %}
  </div>
  
  <!-- Error Display -->
  {% for error in form.activity_level.errors %}
    <div class="text-error text-sm mt-4 text-center">{{ error }}</div>
  {% endfor %}
  
  <!-- Form-level errors -->
  {% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
      <div class="text-error text-sm mt-2 text-center">{{ error }}</div>
    {% endfor %}
  {% endif %}
</div>

<!-- Store pet name for JavaScript -->
<script>
  window.petNameStep10Activity = '{{ form.pet_name|default:"" }}';
  
  // Step 10: Activity level selection handling
  document.addEventListener('DOMContentLoaded', function() {
      const activityButtons = document.querySelectorAll('.activity-level-btn');
      
      function updateButtonStates() {
          activityButtons.forEach(function(button) {
              const radio = button.querySelector('input[type="radio"]');
              if (radio && radio.checked) {
                  button.classList.add('btn-primary');
                  button.classList.remove('btn-outline');
              } else {
                  button.classList.remove('btn-primary');
                  button.classList.add('btn-outline');
              }
          });
      }
      
      // Add click handlers to buttons
      activityButtons.forEach(function(button) {
          button.addEventListener('click', function() {
              const radio = this.querySelector('input[type="radio"]');
              if (radio) {
                  // Uncheck all other radios first
                  document.querySelectorAll('input[name="10-activity_level"]').forEach(function(r) {
                      r.checked = false;
                  });
                  // Check this radio
                  radio.checked = true;
                  updateButtonStates();
              }
          });
      });
      
      // Set initial button states
      updateButtonStates();
      
      // Listen for direct radio changes (in case user clicks radio directly)
      document.querySelectorAll('input[name="10-activity_level"]').forEach(function(radio) {
          radio.addEventListener('change', updateButtonStates);
      });
  });
</script>

<style>
  /* Hide the actual radio buttons but keep them functional */
  .activity-level-btn input[type="radio"] {
      position: absolute;
      opacity: 0;
      pointer-events: none;
  }
  
  /* Ensure button content is properly styled */
  .activity-level-btn {
      min-height: 6rem;
      font-weight: 500;
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      padding: 1.5rem;
  }
  
  /* Hover effects */
  .activity-level-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  
  /* Active state styling */
  .activity-level-btn.btn-primary {
      color: white;
  }
  
  .activity-level-btn.btn-primary .text-sm {
      color: rgba(255, 255, 255, 0.9);
  }
  
  /* Text styling */
  .activity-level-btn .text-xl {
      line-height: 1.3;
  }
  
  .activity-level-btn .text-sm {
      line-height: 1.4;
  }
</style>