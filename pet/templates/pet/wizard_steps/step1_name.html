<!-- Step 1: Pet Name and Type -->
<div class="space-y-6">
    <!-- Pet Image Upload Section -->
    <div class="text-center mb-6">
        <label class="block text-lg font-bold text-gray-700 dark:text-gray-300 mb-4">
            {{ form.image.label }}
        </label>
        <div class="flex flex-col items-center">
            <!-- Image Preview -->
            <div id="image-preview-container" class="mb-4 {% if not pet or not pet.image %}hidden{% endif %}">
                <img id="image-preview" src="{% if pet and pet.image %}{{ pet.image.url }}{% endif %}" alt="Pet preview" class="w-32 h-32 object-cover rounded-full border-4 border-gray-300">
            </div>
            
            <!-- Upload Button -->
            <label for="id_step1-image" class="cursor-pointer inline-flex items-center px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg shadow-md transition duration-200">
                <i class="fas fa-camera mr-2"></i>
                <span id="upload-button-text">{% if pet and pet.image %}Change Image{% else %}Choose Image{% endif %}</span>
            </label>
            {{ form.image }}
            
            <!-- File name display -->
            <p id="file-name" class="text-sm text-gray-600 mt-2 {% if not pet or not pet.image %}hidden{% endif %}">
                {% if pet and pet.image %}{{ pet.image.name|slice:"11:" }}{% endif %}
            </p>
            
            {% if form.image.errors %}
                <p class="text-red-500 text-sm mt-2">{{ form.image.errors|join:"," }}</p>
            {% endif %}
        </div>
    </div>

    <!-- Pet Name Section -->
    <div class="text-center">
        <label class="block text-lg font-bold text-gray-700 dark:text-gray-300 mb-4">
            {{ form.name.label }}
        </label>
        {{ form.name }}
        {% if form.name.errors %}
            <p class="text-red-500 text-sm mt-2">{{ form.name.errors|join:", " }}</p>
        {% endif %}
    </div>

    <!-- Pet Type Section -->
    <div class="text-center">
        <label class="block text-lg font-bold text-gray-700 dark:text-gray-300 mb-4">
            {{ form.pet_type.label }}
        </label>
        <div class="flex justify-center gap-6">
            {% for choice in form.pet_type %}
                <label class="pet-type-btn w-32 bg-white border-2 border-gray-300 rounded-xl p-4 cursor-pointer text-center transition duration-200 hover:border-blue-400">
                    {{ choice.tag }}
                    <div class="pet-type-label">
                        {% if choice.choice_label == "Dog" %}
                            <i class="fa-solid fa-dog text-3xl text-indigo-600 mb-3 block"></i>
                        {% elif choice.choice_label == "Cat" %}
                            <i class="fa-solid fa-cat text-3xl text-pink-500 mb-3 block"></i>
                        {% endif %}
                        <div class="text-base font-medium text-gray-700">{{ choice.choice_label }}</div>
                    </div>
                </label>
            {% endfor %}
        </div>
        {% if form.pet_type.errors %}
            <p class="text-red-500 text-sm mt-3">{{ form.pet_type.errors|join:", " }}</p>
        {% endif %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle image upload preview
    const imageInput = document.getElementById('id_step1-image');
    const imagePreview = document.getElementById('image-preview');
    const imagePreviewContainer = document.getElementById('image-preview-container');
    const fileName = document.getElementById('file-name');
    const uploadButtonText = document.getElementById('upload-button-text');
    
    if (imageInput) {
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // Show file name
                fileName.textContent = file.name;
                fileName.classList.remove('hidden');
                uploadButtonText.textContent = 'Change Image';
                
                // Preview image
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreviewContainer.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        });
    }
    
    // Handle radio button selection styling
    const radioButtons = document.querySelectorAll('input[type="radio"][name="step1-pet_type"]');
    const labels = document.querySelectorAll('.pet-type-btn');
    
    // Function to update button styles
    function updateButtonStyles() {
        labels.forEach(label => {
            const radio = label.querySelector('input[type="radio"]');
            if (radio && radio.checked) {
                label.classList.add('border-blue-600', 'bg-blue-50');
                label.classList.remove('border-gray-300');
            } else {
                label.classList.remove('border-blue-600', 'bg-blue-50');
                label.classList.add('border-gray-300');
            }
        });
    }
    
    // Add click handlers
    labels.forEach(label => {
        label.addEventListener('click', function() {
            const radio = this.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
                updateButtonStyles();
            }
        });
    });
    
    // Initial styling
    updateButtonStyles();
});
</script>