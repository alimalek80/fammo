{% extends 'userapp/dashboard_base.html' %}
{% load i18n %}

{% block dashboard_content %}
<div class="w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-xl p-10">
    <h2 class="text-3xl font-extrabold mb-8 text-gray-800 text-center">{% trans "Admin Statistics" %}</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mb-10">
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-users text-4xl text-blue-500 mb-3"></i>
            <div class="text-lg font-semibold text-blue-800">{% trans "Total Users" %}</div>
            <div class="text-3xl font-bold text-blue-700">{{ total_users }}</div>
        </div>
        <div class="bg-green-50 border border-green-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-paw text-4xl text-green-500 mb-3"></i>
            <div class="text-lg font-semibold text-green-800">{% trans "Total Pets" %}</div>
            <div class="text-3xl font-bold text-green-700">{{ total_pets }}</div>
        </div>
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-dog text-4xl text-yellow-500 mb-3"></i>
            <div class="text-lg font-semibold text-yellow-800">{% trans "Dogs" %}</div>
            <div class="text-3xl font-bold text-yellow-700">{{ total_dogs }}</div>
        </div>
        <div class="bg-pink-50 border border-pink-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-cat text-4xl text-pink-500 mb-3"></i>
            <div class="text-lg font-semibold text-pink-800">{% trans "Cats" %}</div>
            <div class="text-3xl font-bold text-pink-700">{{ total_cats }}</div>
        </div>
        <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-bowl-food text-4xl text-indigo-500 mb-3"></i>
            <div class="text-lg font-semibold text-indigo-800">{% trans "AI Meals" %}</div>
            <div class="text-3xl font-bold text-indigo-700">{{ total_ai_meals }}</div>
        </div>
        <div class="bg-red-50 border border-red-200 rounded-xl p-6 flex flex-col items-center shadow hover:shadow-lg transition">
            <i class="fa-solid fa-heart-pulse text-4xl text-red-500 mb-3"></i>
            <div class="text-lg font-semibold text-red-800">{% trans "AI Health Reports" %}</div>
            <div class="text-3xl font-bold text-red-700">{{ total_ai_health }}</div>
        </div>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-8 shadow flex flex-col items-center">
        <h3 class="text-2xl font-bold mb-6 text-gray-800">{% trans "Top Countries by AI Requests" %}</h3>
        <div class="w-full max-w-2xl">
            <canvas id="countryChart" width="400" height="200"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const countryData = {
        labels: [{% for country, count in top_countries %}"{{ country|default:'Unknown' }}",{% endfor %}],
        datasets: [{
            label: 'Requests',
            data: [{% for country, count in top_countries %}{{ count }},{% endfor %}],
            backgroundColor: 'rgba(54, 162, 235, 0.5)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
        }]
    };
    const ctx = document.getElementById('countryChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: countryData,
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                x: { ticks: { color: '#334155', font: { weight: 'bold' } } },
                y: { beginAtZero: true, ticks: { color: '#334155', font: { weight: 'bold' } } }
            }
        }
    });
</script>
{% endblock %}